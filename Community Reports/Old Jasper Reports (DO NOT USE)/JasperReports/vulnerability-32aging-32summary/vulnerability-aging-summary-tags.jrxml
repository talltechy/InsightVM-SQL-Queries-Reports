<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="vulnerability-aging-summary-sites" pageWidth="752" pageHeight="612" orientation="Landscape" whenNoDataType="NoDataSection" columnWidth="752" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0" whenResourceMissingType="Empty" uuid="f4be0f05-ef8d-426b-b0ac-16b7284e8991">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="REPORT_NAME" class="java.lang.String"/>
	<queryString>
		<![CDATA[WITH
   asset_vuln_finding_age AS (
   -- List the age of vuln findings in scope, along with their asset information
   SELECT avd.asset_id,
      CASE WHEN (avd.age < 30 AND dv.severity_score < 4) THEN 1 ELSE 0 END AS "<30m",
      CASE WHEN (avd.age < 30 AND dv.severity_score >= 4 AND dv.severity_score < 8) THEN 1 ELSE 0 END AS "<30s",
      CASE WHEN (avd.age < 30 AND dv.severity_score >= 8) THEN 1 ELSE 0 END AS "<30c",
      CASE WHEN (avd.age < 60 AND avd.age >= 30 AND dv.severity_score < 4) THEN 1 ELSE 0 END AS "30-60m",
      CASE WHEN (avd.age < 60 AND avd.age >= 30 AND dv.severity_score >= 4 AND dv.severity_score < 8) THEN 1 ELSE 0 END AS "30-60s",
      CASE WHEN (avd.age < 60 AND avd.age >= 30 AND dv.severity_score >= 8) THEN 1 ELSE 0 END AS "30-60c",
      CASE WHEN (avd.age < 90 AND avd.age >= 60 AND dv.severity_score < 4) THEN 1 ELSE 0 END AS "60-90m",
      CASE WHEN (avd.age < 90 AND avd.age >= 60 AND dv.severity_score >= 4 AND dv.severity_score < 8) THEN 1 ELSE 0 END AS "60-90s",
      CASE WHEN (avd.age < 90 AND avd.age >= 60 AND dv.severity_score >= 8) THEN 1 ELSE 0 END AS "60-90c",
      CASE WHEN (avd.age >= 90 AND dv.severity_score < 4) THEN 1 ELSE 0 END AS "90+m",
      CASE WHEN (avd.age >= 90 AND dv.severity_score >= 4 AND dv.severity_score < 8) THEN 1 ELSE 0 END AS "90+s",
      CASE WHEN (avd.age >= 90 AND dv.severity_score >= 8) THEN 1 ELSE 0 END AS "90+c"
   FROM (
      -- Find earliest finding date for a vuln, coupled with the most recent instance count for the vuln
      SELECT fasv.asset_id, fasv.vulnerability_id, date_part('days', (CURRENT_DATE - MIN (fasv.date)) + interval '1 day') AS age
      FROM fact_asset_scan_vulnerability_instance fasv
         -- Filter to only include vuln findings present in the latest scan
         JOIN fact_asset_vulnerability_instance fav ON fasv.asset_id = fav.asset_id
            AND fasv.vulnerability_id = fav.vulnerability_id
            AND fasv.service_id = fav.service_id
            AND fasv.port = fav.port
            AND fasv.proof = fav.proof
      GROUP BY fasv.asset_id, fasv.vulnerability_id
   ) avd
   JOIN dim_vulnerability dv ON dv.vulnerability_id = avd.vulnerability_id
   )
SELECT *
FROM (
SELECT dag.tag_name AS group_name,
   COUNT(DISTINCT vfa.asset_id) AS asset_count,
   SUM(vfa."<30m") AS "<30_moderate",
   SUM(vfa."<30s") AS "<30_severe",
   SUM(vfa."<30c") AS "<30_critical",
   SUM(vfa."30-60m") AS "30-60_moderate",
   SUM(vfa."30-60s") AS "30-60_severe",
   SUM(vfa."30-60c") AS "30-60_critical",
   SUM(vfa."60-90m") AS "60-90_moderate",
   SUM(vfa."60-90s") AS "60-90_severe",
   SUM(vfa."60-90c") AS "60-90_critical",
   SUM(vfa."90+m") AS "90+_moderate",
   SUM(vfa."90+s") AS "90+_severe",
   SUM(vfa."90+c") AS "90+_critical",
   SUM(vfa."<30m") + SUM(vfa."<30s")+ SUM(vfa."<30c") + SUM(vfa."30-60m")+ SUM(vfa."30-60s") + SUM(vfa."30-60c") +
   SUM(vfa."60-90m") + SUM(vfa."60-90s") + SUM(vfa."60-90c") + SUM(vfa."90+m") + SUM(vfa."90+s") + SUM(vfa."90+c") AS vuln_count
FROM (
   SELECT *
   FROM asset_vuln_finding_age
   UNION ALL
   -- Include zero counts for assets that have no vuln findings
   SELECT da.asset_id, 0 AS "<30m", 0 AS "<30s", 0 AS "<30c", 0 AS "30-60m", 0 AS "30-60s", 0 AS "30-60c",
      0 AS "60-90m", 0 AS "60-90s", 0 AS "90+m", 0 AS "60-90c", 0 AS "90+s", 0 AS "90+c"
   FROM dim_tag_asset da

   WHERE asset_id NOT IN (SELECT DISTINCT asset_id FROM asset_vuln_finding_age)
) vfa
JOIN dim_tag_asset daga ON daga.asset_id = vfa.asset_id
JOIN dim_scope_tag USING (tag_id)
JOIN dim_tag dag USING (tag_id)
GROUP BY dag.tag_name
) site_vuln_counts
UNION ALL
-- Include zero counts for asset groups in scope with no assets
SELECT dag.tag_name AS group_name, 0 AS asset_count, 0 AS "<30m", 0 AS "<30s", 0 AS "<30c", 0 AS "30-60m", 0 AS "30-60s", 0 AS "30-60c",
      0 AS "60-90m", 0 AS "60-90s", 0 AS "90+m", 0 AS "60-90c", 0 AS "90+s", 0 AS "90+c", 0 AS vuln_count
FROM dim_scope_tag dsag
   JOIN dim_tag dag USING(tag_id)
WHERE dsag.tag_id NOT IN (
   SELECT DISTINCT daga.tag_id
   FROM dim_asset da
      JOIN dim_tag_asset daga USING(asset_id)
)
ORDER BY group_name]]>
	</queryString>
	<field name="group_name" class="java.lang.String"/>
	<field name="asset_count" class="java.lang.Long"/>
	<field name="&lt;30_moderate" class="java.lang.Long"/>
	<field name="&lt;30_severe" class="java.lang.Long"/>
	<field name="&lt;30_critical" class="java.lang.Long"/>
	<field name="30-60_moderate" class="java.lang.Long"/>
	<field name="30-60_severe" class="java.lang.Long"/>
	<field name="30-60_critical" class="java.lang.Long"/>
	<field name="60-90_moderate" class="java.lang.Long"/>
	<field name="60-90_severe" class="java.lang.Long"/>
	<field name="60-90_critical" class="java.lang.Long"/>
	<field name="90+_moderate" class="java.lang.Long"/>
	<field name="90+_severe" class="java.lang.Long"/>
	<field name="90+_critical" class="java.lang.Long"/>
	<field name="vuln_count" class="java.lang.Long"/>
	<variable name="REPORT_DATE" class="java.util.Date">
		<variableExpression><![CDATA[new java.util.Date()]]></variableExpression>
	</variable>
	<variable name="total_assets" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{asset_count}]]></variableExpression>
	</variable>
	<variable name="total_vulns" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{vuln_count}]]></variableExpression>
	</variable>
	<variable name="total_30m" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{<30_moderate}]]></variableExpression>
	</variable>
	<variable name="total_3060m" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{30-60_moderate}]]></variableExpression>
	</variable>
	<variable name="total_6090m" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{60-90_moderate}]]></variableExpression>
	</variable>
	<variable name="total_90m" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{90+_moderate}]]></variableExpression>
	</variable>
	<variable name="total_30s" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{<30_severe}]]></variableExpression>
	</variable>
	<variable name="total_3060s" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{30-60_severe}]]></variableExpression>
	</variable>
	<variable name="total_6090s" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{60-90_severe}]]></variableExpression>
	</variable>
	<variable name="total_90s" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{90+_severe}]]></variableExpression>
	</variable>
	<variable name="total_30c" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{<30_critical}]]></variableExpression>
	</variable>
	<variable name="total_3060c" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{30-60_critical}]]></variableExpression>
	</variable>
	<variable name="total_6090c" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{60-90_critical}]]></variableExpression>
	</variable>
	<variable name="total_90c" class="java.lang.Long" calculation="Sum">
		<variableExpression><![CDATA[$F{90+_critical}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="25">
			<textField>
				<reportElement uuid="6bcd5166-0a2d-4f72-909b-2dc59a04460f" x="0" y="0" width="752" height="25"/>
				<textElement>
					<font fontName="Arial" size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{title_by_tag}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="40" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="5744ca85-7163-47f6-ae6e-01699c78ab99" mode="Opaque" x="0" y="0" width="144" height="40" backcolor="#F0F0F0"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{tag_name}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="5744ca85-7163-47f6-ae6e-01699c78ab99" mode="Opaque" x="144" y="0" width="53" height="40" backcolor="#F0F0F0"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{asset_count}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="5744ca85-7163-47f6-ae6e-01699c78ab99" mode="Opaque" x="432" y="0" width="160" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{severe}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="5744ca85-7163-47f6-ae6e-01699c78ab99" mode="Opaque" x="592" y="0" width="160" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{critical}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="272" y="20" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[<30]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="312" y="20" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[30-60]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="352" y="20" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[60-90]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="392" y="20" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[90+]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="472" y="20" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[30-60]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="432" y="20" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[<30]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="552" y="20" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[90+]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="512" y="20" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[60-90]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="632" y="20" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[30-60]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="592" y="20" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[<30]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="712" y="20" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[90+]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="76eb08c1-7e4d-461b-b53d-cc3d7a559f32" mode="Opaque" x="672" y="20" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isStrikeThrough="false"/>
				</textElement>
				<text><![CDATA[60-90]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="5744ca85-7163-47f6-ae6e-01699c78ab99" mode="Opaque" x="272" y="0" width="160" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{moderate}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement uuid="5744ca85-7163-47f6-ae6e-01699c78ab99" mode="Opaque" x="197" y="0" width="75" height="40" backcolor="#F0F0F0"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.5"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{vuln_count}]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="20">
			<textField>
				<reportElement uuid="3c90f22f-dc7a-4ee6-afa3-d46eeb04aa67" stretchType="RelativeToTallestObject" mode="Opaque" x="272" y="0" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{<30_moderate}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="5305ccb2-22a5-40bb-bc98-792dcaa38c4f" stretchType="RelativeToTallestObject" mode="Opaque" x="432" y="0" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{<30_severe}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b346d685-83c6-4873-9e7a-3688dc4fb09c" stretchType="RelativeToTallestObject" mode="Opaque" x="592" y="0" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{<30_critical}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="3f38cc88-ed31-4403-9ce2-92d10e5753c0" stretchType="RelativeToTallestObject" mode="Opaque" x="312" y="0" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{30-60_moderate}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="12139c52-c8ee-4bf7-8575-1de0be41fa9c" stretchType="RelativeToTallestObject" mode="Opaque" x="472" y="0" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{30-60_severe}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="b0b577e2-0585-4cac-9665-2abb99d4d388" stretchType="RelativeToTallestObject" mode="Opaque" x="632" y="0" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{30-60_critical}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="d273345b-ca8b-4e3f-907e-615990c88f9f" stretchType="RelativeToTallestObject" mode="Opaque" x="352" y="0" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{60-90_moderate}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="4039098e-19ee-4b3e-ae28-5786209f8e2b" stretchType="RelativeToTallestObject" mode="Opaque" x="512" y="0" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{60-90_severe}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="0c85bd63-e395-4f41-a3b8-9a8f863a47d5" stretchType="RelativeToTallestObject" mode="Opaque" x="672" y="0" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{60-90_critical}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="5871905f-c62a-4811-bd50-9e52a2460e19" stretchType="RelativeToTallestObject" mode="Opaque" x="392" y="0" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{90+_moderate}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="00333362-5585-49ea-a370-db824dbf1d46" stretchType="RelativeToTallestObject" mode="Opaque" x="552" y="0" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{90+_severe}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="662e24b8-85af-44ad-b94a-f9e13676e2d2" stretchType="RelativeToTallestObject" mode="Opaque" x="712" y="0" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{90+_critical}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true">
				<reportElement uuid="51231d55-d489-4a3a-89e9-dd185373d336" stretchType="RelativeToTallestObject" mode="Opaque" x="0" y="0" width="144" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph leftIndent="5" tabStopWidth="20"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{group_name}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="144" y="0" width="53" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{asset_count}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="197" y="0" width="75" height="20"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{vuln_count}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="20">
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="312" y="0" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_3060m}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="472" y="0" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_3060s}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="272" y="0" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_30m}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="392" y="0" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_90m}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="432" y="0" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_30s}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="552" y="0" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_90s}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="197" y="0" width="75" height="20" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_vulns}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="592" y="0" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_30c}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="632" y="0" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_3060c}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="672" y="0" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_6090c}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="144" y="0" width="53" height="20" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_assets}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="352" y="0" width="40" height="20" backcolor="#FFFF7F"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_6090m}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="712" y="0" width="40" height="20" backcolor="#FF4949"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_90c}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="512" y="0" width="40" height="20" backcolor="#FFAC59"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph rightIndent="3"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{total_6090s}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="61b1727c-2c61-4622-84be-2046d02c7e85" stretchType="RelativeToTallestObject" mode="Opaque" x="0" y="0" width="144" height="20" backcolor="#FFFFFF"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" size="8" isBold="true" isItalic="false"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$R{total_summary}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
